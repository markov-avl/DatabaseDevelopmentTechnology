\section{Даталогическая модель}\label{sec:datalogical-model}

\subsection{Обзор СУБД <<Microsoft Access>>}

Microsoft Access -- это реляционная система управления базами данных (СУБД), входящая в пакет MS Office.

Все составляющие базы данных, такие, как таблицы, отчеты, запросы, формы и объекты, в Access хранятся в едином дисковом файле, который имеет расширение \texttt{.accdb}.

Основным структурным компонентом базы данных является таблица. В таблицах хранятся вводимые данные. Каждая таблица состоит из столбцов, называемых полями, и строк, называемых записями. Каждая запись таблицы содержит всю необходимую информацию об отдельном элементе базы данных.

При разработке структуры таблицы, прежде всего, необходимо задать поля, определив их свойства. Свойства полей таблиц представлены в таблице \ref{tab:field-properties}.

\renewcommand{\arraystretch}{1.5}
\begin{xltabular}[h]{\textwidth}{|p{0.2 \textwidth}|X|}
    \caption{Свойства полей таблицы\label{tab:field-properties}} \\
    \hline
    \textbf{Свойство} & \textbf{Его назначение} \\
    \hline \endhead
    Имя поля & Определяет, как следует обращаться к данным этого поля. Должно быть уникальным, желательно таким, чтобы функция поля узнавалась по его имени. \\ \hline
    Тип поля & Определяет тип данных, которые содержаться в данном поле. \\ \hline
    Размер поля & Определяет предельную длину (в символах) данных, которые могут размещаться в данном поле. \\ \hline
    Формат поля & Определяет способ форматирования данных в ячейках, принадлежащих полю. \\ \hline
    Маска ввода & Определяет форму, в которой вводятся данные в поле. \\ \hline
    Подпись & Определяет заголовок столбца таблицы для данного поля. Если не указана, то в качестве заголовка используется имя поля. \\ \hline
    Значение по умолчанию & Значение, которое вводится в ячейки поля автоматически. \\ \hline
    Условие на значение & Ограничение, используемое для проверки правильности ввода данных \\ \hline
    Сообщение об ошибке & Текстовое сообщение, которое выдается автоматически при попытке ввода в поле ошибочных данных. \\ \hline
    Обязательное поле & Определяет обязательность заполнения поля данными. \\ \hline
    Пустые строки & Разрешает ввод пустых строковых данных \\ \hline
    Индексирован-ное поле & Позволяет ускорять все операции, связанные с поиском или сортировкой данных этого поля. Можно также задать проверку на наличие повторов для этого поля, чтобы исключить дублирование данных. \\ \hline
\end{xltabular}

Необходимо отметить, что свойства полей существенно зависят от типа данных, содержащихся в поле. Типы данных представлены в таблице \ref{tab:data-types}.

\begin{xltabular}[h]{\textwidth}{|p{0.2 \textwidth}|X|}
    \caption{Типы данных\label{tab:data-types}} \\
    \hline
    \textbf{Тип данных} & \textbf{Описание} \\
    \hline \endhead
    Текстовый (по умолчанию) & Текст или числа, не требующие проведения расчетов, например номера телефонов (до 255 знаков). \\ \hline
    Числовой & Числовые данные различных форматов, используемые для проведения расчетов. \\ \hline
    Дата/время & Для хранения календарных дат и текущего времени \\ \hline
    Денежный & Для хранения больших объемов текста (до 65535 символов). \\ \hline
    Счетчик & Специальное числовое поле, в котором Access автоматически присваивает уникальный порядковый номер каждой записи. Значения полей типа счетчика обновлять нельзя. \\ \hline
    Логический & Может иметь только одно из двух возможных значений (True/False, Да/Нет). \\ \hline
    Поле объекта OLE & Объект (например, электронная таблица Microsoft Excel, документ Microsoft Word, рисунок, звукозапись или другие данные в двоичном формате), связанный или внедренный в таблицу Access. \\ \hline
    Гиперссылка & Для хранения адресов URL Web-объектов Интернета. \\ \hline
    Мастер подстановок & Создает поле, в котором предлагается выбор значений из списка или из поля со списком, содержащего набор постоянных значений или значений из другой таблицы. Это в действительности не тип поля, а способ хранения поля. \\ \hline
\end{xltabular}


\renewcommand{\img}[2]{
    \begin{figure}[H]
        \center{\includegraphics[scale=0.9]{graphics/#1}}
        \caption{#2}
        \label{fig:#1}
    \end{figure}
}
\renewcommand{\tab}{\hspace{1cm}}

\setlist[enumerate, 1]{align=left, leftmargin=0cm, labelindent=1cm, listparindent=1cm, labelwidth=*, itemindent=2cm}
\setlist[itemize, 1]{align=left, leftmargin=1cm, labelindent=2cm, listparindent=1cm, labelwidth=*, itemindent=2cm}


Объекты базы данных:
\begin{enumerate}
    \item \textbf{Таблицы}
    
    \tab Строки в таблице называются записями. В записи содержатся блоки информации. Каждая запись состоит по крайней мере из одного поля. Поля соответствуют столбцам в таблице. Поля выделяются под определенные типы данных, например текстовые, цифровые или иные данные. Пример таблицы представлен на рисунке \ref{fig:table-example}.
    % \img{table-example}{Пример таблицы в Access}

    \tab В таблице MS Access присутствуют три основных понятия:
    \begin{itemize}
        \item \textbf{Запись.} Содержит конкретные данные, например информацию об определенном работнике или продукте.
        \item \textbf{Поле.} Содержит данные об одном аспекте элемента таблицы, например имя или адрес электронной почты.
        \item \textbf{Значение поля.} Каждая запись содержит значение поля, например номер комнаты или название фирмы
    \end{itemize}


    \item \textbf{Формы.}
    
    \tab Форма в Access -- это объект базы данных, который можно использовать для создания пользовательского интерфейса для приложения базы данных. <<Связанная>> форма напрямую связана с источником данных, например таблицей или запросом, и может использоваться для ввода, редактирования или отображения данных из этого источника. Кроме того, можно создать <<несвязанную>> форму. Она не привязывается непосредственно к источнику данных, но также содержит кнопки команд, метки или другие элементы управления, которые необходимы для работы с приложением. Пример формы представлен на рисунке \ref{fig:form-example}.
    % \img{form-example}{Пример формы}


    \item \textbf{Отчёты}
    
    \tab Отчёт -- это объект базы данных, удобный для представления ее информации с одной из следующих целей:
    \begin{itemize}
        \item отображение или распространение сводки данных;
        \item архивирование моментальных снимков данных;
        \item предоставление сведений об отдельных записях;
        \item создание надписей.
    \end{itemize}

    \tab Пример отчета представлен на рисунке \ref{fig:report-example}.
    % \img{report-example}{Пример отчёта}
    

    \item \textbf{Запросы}
    
    \tab Запросы упрощают просмотр, добавление, удаление или изменение данных в базе данных Access. Среди других целей использования запросов можно отметить:
    \begin{itemize}
        \item быстрый поиск определенных данных путем фильтрации с применением определенных критериев (условий);
        \item вычисление или сведение данных;
        \item автоматизированное управление данными, например регулярный просмотр актуальных данных.
    \end{itemize}
    
    \tab Пример запроса представлен на рисунке \ref{fig:query-example}.
    % \img{query-example}{Пример запроса}


    \item \textbf{Макрос}
    
    \tab Макрос -- это инструмент, позволяющий автоматизировать задачи и добавлять функции в формы, отчеты и элементы управления. Например, если добавить в форму кнопку, то можно связать ее свойство события \texttt{OnClick} с макросом и включить в него команды, которые должны выполняться при нажатии этой кнопки. Пример макроса представлен на рисунке \ref{fig:macros-example}.
    % \img{macros-example}{Пример макроса}


    \item \textbf{Модуль}
    
    \tab Модуль -- это объект в базах данных рабочего стола, содержащий пользовательские процедуры, которые вы кодируете с помощью Visual Basic. Модули обеспечивают более дискретный поток действий и позволяют отлавливать ошибки. С его помощью редактор существенно расширяет функционал. Достигается это благодаря использованию функций и процедур, призванных реагировать на те или иные изменения. Пример модуля представлен на рисунке \ref{fig:module-example}.
    % \img{module-example}{Пример модуля}
\end{enumerate}


\subsection{Описание таблиц базы данных}


\renewcommand{\img}[2]{
    \begin{figure}[H]
        \center{\includegraphics[scale=0.6]{screenshots/#1}}
        \caption{#2}
        \label{screen:#1}
    \end{figure}
}
\newcommand{\longimg}[2]{
    \begin{figure}[H]
        \center{\includegraphics[scale=0.4]{screenshots/#1}}
        \caption{#2}
        \label{screen:#1}
    \end{figure}
}


\begin{enumerate}
    \item \textbf{Таблица <<Телефонные номера>>}
    \img{phone-numbers}{Структура таблицы <<Телефонные номера>>}
    \img{phone-numbers-phone-number}{Свойства поля <<Телефонный номер>>}
    \img{phone-numbers-free}{Свойства поля <<Свободный>>}

    \item \textbf{Таблица <<Тарифы>>}
    \img{tariffs}{Структура таблицы <<Тарифы>>}
    \img{tariffs-name}{Свойства поля <<Название>>}
    \img{tariffs-fee}{Свойства поля <<Абонентская плата>>}
    \img{tariffs-traffic}{Свойства поля <<Интернет трафик>>}
    \img{tariffs-minutes}{Свойства поля <<Количество минут>>}
    \img{tariffs-sms}{Свойства поля <<Количество SMS>>}

    \item \textbf{Таблица <<SIM-карты>>}
    \img{sim-cards}{Структура таблицы <<SIM-карты>>}
    \img{sim-cards-account}{Свойства поля <<Абонентский счёт>>}
    \img{sim-cards-balance}{Свойства поля <<Баланс на абонентском счёте>>}
    \img{sim-cards-phone-number}{Свойства поля <<Телефонный номер>>}
    \img{sim-cards-tariff}{Свойства поля <<Подключённый тариф>>}

    \item \textbf{Таблица <<Клиенты>>}
    \img{clients}{Структура таблицы <<Клиенты>>}
    \longimg{clients-passport}{Свойства поля <<Серия и номер паспорта>>}
    \img{clients-full-name}{Свойства поля <<ФИО>>}
    \img{clients-birthday}{Свойства поля <<Дата рождения клиента>>}
    \img{clients-address}{Свойства поля <<Место прописки>>}

    \item \textbf{Таблица <<Места прописок>>}
    \img{addresses}{Структура таблицы <<Места прописок>>}
    \img{addresses-id}{Свойства поля <<Порядковый номер>>}
    \img{addresses-address}{Свойства поля <<Место прописки>>}

    \item \textbf{Таблица <<Абоненты>>}
    \img{subscribers}{Структура таблицы <<Абоненты>>}
    \img{subscribers-account}{Свойства поля <<Абонентский счёт>>}
    \longimg{subscribers-phone-number}{Свойства поля <<Телефонный номер>>}
    \img{subscribers-sign-date}{Свойства поля <<Дата подписания договора>>}
    \img{subscribers-cancel-date}{Свойства поля <<Дата расторжения договора>>}

    \item \textbf{Таблица <<Менеджеры>>}
    \img{managers}{Структура таблицы <<Менеджеры>>}
    \img{login}{Свойства поля <<Логин>>}
    \img{password}{Свойства поля <<Пароль>>}

    \item \textbf{Таблица <<Продавцы-консультанты>>}
    \img{shop-assistants}{Структура таблицы <<Продавцы-консультанты>>}
    \img{login}{Свойства поля <<Логин>>}
    \img{password}{Свойства поля <<Пароль>>}
\end{enumerate}


\subsection{Схема данных}


\longimg{scheme}{Схема данных}